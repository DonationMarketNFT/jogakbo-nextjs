{"ast":null,"code":"import { Fragment as _Fragment } from \"react/jsx-runtime\";\nimport { jsxs as _jsxs } from \"react/jsx-runtime\";\nimport { jsx as _jsx } from \"react/jsx-runtime\";\nimport { faTimes } from \"@fortawesome/free-solid-svg-icons\";\nimport { FontAwesomeIcon } from \"@fortawesome/react-fontawesome\";\nimport { JogakboContract } from \"api/UseCaver\"; // import {JogakboContract, rs} from \"api/UseCaver\";\n\nimport * as KlipAPI from \"../../api/UseKlip\";\nimport axios from \"axios\";\nimport Caver, { ABI } from \"caver-js\";\nimport { JOGAKBO_CONTRACT_ADDRESS } from \"constants/constants.baobab\";\nimport { useEffect, useState } from \"react\";\nimport { useRecoilState } from \"recoil\";\nimport styled from \"styled-components\";\nimport { myAddressState, qrValueState, showConnectWalletModalState, VerifyModalState } from \"../../../atom\";\nimport JOGAKBOABI from \"../../abi/JogakboABI.json\";\nimport ConnectWalletModal from \"components/modals/ConnectWalletModal\";\nimport { postCampaign } from \"api/campaigns\";\nconst Container = /*#__PURE__*/styled.div.withConfig({\n  displayName: \"VerifyCampaignModal__Container\",\n  componentId: \"sc-gbyuch-0\"\n})([\"position:fixed;top:0;left:0;width:100%;height:100%;display:flex;justify-content:center;align-items:center;background:rgba(0,0,0,0.5);z-index:9999;\"]);\nconst Modal = /*#__PURE__*/styled.div.withConfig({\n  displayName: \"VerifyCampaignModal__Modal\",\n  componentId: \"sc-gbyuch-1\"\n})([\"display:flex;flex-direction:column;justify-content:space-between;padding:30px;width:80%;height:75%;background:#fff;div{font-size:24px;margin-bottom:15px;}\"]);\nconst ModalHeader = /*#__PURE__*/styled.div.withConfig({\n  displayName: \"VerifyCampaignModal__ModalHeader\",\n  componentId: \"sc-gbyuch-2\"\n})([\"display:flex;align-items:center;svg{font-size:36px;}\"]);\nconst Name = /*#__PURE__*/styled.h5.withConfig({\n  displayName: \"VerifyCampaignModal__Name\",\n  componentId: \"sc-gbyuch-3\"\n})([\"width:100%;font-size:34px;text-align:center;\"]);\nconst Contents = /*#__PURE__*/styled.div.withConfig({\n  displayName: \"VerifyCampaignModal__Contents\",\n  componentId: \"sc-gbyuch-4\"\n})([\"display:flex;flex-direction:column;height:100%;\"]);\nconst Buttons = /*#__PURE__*/styled.div.withConfig({\n  displayName: \"VerifyCampaignModal__Buttons\",\n  componentId: \"sc-gbyuch-5\"\n})([\"display:flex;justify-content:center;div{margin:0 10px;}\"]);\nconst DeleteButton = /*#__PURE__*/styled.div.withConfig({\n  displayName: \"VerifyCampaignModal__DeleteButton\",\n  componentId: \"sc-gbyuch-6\"\n})([\"padding:10px 15px;background:red;border-radius:5px;color:white;cursor:pointer;\"]);\nconst OnChainButton = /*#__PURE__*/styled.div.withConfig({\n  displayName: \"VerifyCampaignModal__OnChainButton\",\n  componentId: \"sc-gbyuch-7\"\n})([\"padding:10px 15px;background:blue;border-radius:5px;color:white;cursor:pointer;\"]); // interface IDate {\n//   id: number;\n//   name: string;\n//   description: string;\n//   campaignId: number;\n//   currentAmount?: number;\n//   targetAmount: number;\n//   fundingState: boolean;\n//   refundState: boolean;\n//   category: string;\n//   creatorAddress: string;\n//   minFundingAmount: string;\n// }\n// interface Klaytn {\n//   on: (eventName: string, callback: () => void) => void;\n//   enable: () => Promise<Array<string>>;\n//   selectedAddress: string;\n//   networkVersion: number;\n//   publicConfigStore: Store;\n// }\n// interface State {\n//   isEnabled: boolean;\n//   isUnlocked: boolean;\n//   networkVersion: number;\n//   onboardingcomplete: boolean;\n// }\n// interface Store {\n//   subscribe: (callback: () => void) => void;\n//   getState: () => State;\n// }\n// declare global {\n//   interface Window {\n//     klaytn: any;\n//   }\n// }\n// const VerifyCampaignModal = (props: {id: number; name: string}) => {\n\nconst VerifyCampaignModal = props => {\n  const [showModal, setShowModal] = useRecoilState(VerifyModalState);\n  const [showConnectWalletModal, setShowConnectWalletModal] = useRecoilState(showConnectWalletModalState); // const [data, setData] = useState<IDate>();\n\n  const {\n    0: data,\n    1: setData\n  } = useState();\n  const [myAddress, setMyAddress] = useRecoilState(myAddressState);\n  const [qrValue, setQrValue] = useRecoilState(qrValueState);\n  useEffect(() => {\n    axios(`http://ec2-52-78-57-218.ap-northeast-2.compute.amazonaws.com:3000/pre-campaigns/campaign/${props.id}`).then(res => setData(res.data)).catch(e => console.log(e));\n    console.log(myAddress);\n  }, []);\n\n  const deleteData = () => {\n    axios.delete(`http://ec2-52-78-57-218.ap-northeast-2.compute.amazonaws.com:3000/pre-campaigns/campaign/delete/${props.id}`).then(res => console.log(res)).catch(e => console.log(e));\n    setShowModal(false);\n    location.reload();\n  };\n\n  const create = () => {\n    KlipAPI.createCampaign(data.creatorAddress, data.targetAmount, props.id, setQrValue, result => {\n      alert(JSON.stringify(result));\n      setShowConnectWalletModal(false);\n    });\n    setShowConnectWalletModal(true);\n    postCampaign(props.name, data.description, data.targetAmount, data.category, data.minFundingAmount, data.creatorAddress);\n  }; // const create = async () => {\n  //   console.log(window.klaytn);\n  //   let kly;\n  //   if (typeof window !== \"undefined\") {\n  //     kly = window.klaytn;\n  //   }\n  //   const caver = new Caver(kly);\n  //   console.log(caver);\n  //   const JogakboContract = new caver.klay.Contract(\n  //     JOGAKBOABI,\n  //     JOGAKBO_CONTRACT_ADDRESS,\n  //   );\n  //   console.log(JogakboContract);\n  //   const tx = {\n  //     type: \"SMART_CONTRACT_EXECUTION\",\n  //     from: kly.selectedAddress,\n  //     to: JOGAKBO_CONTRACT_ADDRESS,\n  //     data: JogakboContract.methods.createCampaign(\n  //       data?.creatorAddress,\n  //       data?.targetAmount,\n  //       data?.campaignId,\n  //     ),\n  //     // .encodeABI(),\n  //     gas: \"8000000\",\n  //     value: \"0\",\n  //   };\n  //   await caver.klay.sendTransaction(tx).then(res => console.log(res));\n  //   // await caver.klay\n  //   //   .sendTransaction({\n  //   //     type: \"VALUE_TRANSFER\",\n  //   //     from: \"0xA52c3f53F087B3445190ADc0B038Bd78D8110eDa\",\n  //   //     to: \"0xc72af0d3c40d5E95e3424b251ceA0cD81e230Dc1\",\n  //   //     gas: \"300000\",\n  //   //     value: caver.utils.toPeb(\"1\", \"KLAY\"),\n  //   //   })\n  //   //   .then(res => console.log(res));\n  // };\n\n\n  const onChangeImage = async e => {\n    e.preventDefault();\n\n    if (e.target.files) {\n      const formData = new FormData();\n\n      for (var i = 0; i < e.target.files.length; i++) {\n        formData.append(\"images\", e.target.files[i]);\n      }\n\n      formData.append(\"CampaignId\", props.id);\n      formData.append(\"CampaignDescription\", data === null || data === void 0 ? void 0 : data.description);\n      formData.append(\"CampaignName\", data === null || data === void 0 ? void 0 : data.name);\n      await axios({\n        method: \"post\",\n        url: \"http://ec2-52-78-57-218.ap-northeast-2.compute.amazonaws.com:3000/image\",\n        data: formData,\n        headers: {\n          \"Content-Type\": \"multipart/form-data\"\n        }\n      }).then(res => console.log(\"성공\")).catch(e => console.error(e));\n    }\n  };\n\n  return /*#__PURE__*/_jsx(_Fragment, {\n    children: /*#__PURE__*/_jsxs(Container, {\n      onClick: () => setShowModal(false),\n      children: [/*#__PURE__*/_jsxs(Modal, {\n        onClick: e => {\n          e.stopPropagation();\n        },\n        children: [/*#__PURE__*/_jsxs(ModalHeader, {\n          children: [/*#__PURE__*/_jsx(Name, {\n            children: props.name\n          }), /*#__PURE__*/_jsx(FontAwesomeIcon, {\n            onClick: () => setShowModal(false),\n            icon: faTimes\n          })]\n        }), /*#__PURE__*/_jsxs(Contents, {\n          children: [/*#__PURE__*/_jsxs(\"div\", {\n            children: [\"id: \", props.id]\n          }), /*#__PURE__*/_jsxs(\"div\", {\n            children: [\"\\uC81C\\uCD9C\\uC790 \\uC8FC\\uC18C: \", data === null || data === void 0 ? void 0 : data.creatorAddress]\n          }), /*#__PURE__*/_jsxs(\"div\", {\n            children: [\"\\uCE74\\uD14C\\uACE0\\uB9AC: \", data === null || data === void 0 ? void 0 : data.category]\n          }), /*#__PURE__*/_jsxs(\"div\", {\n            children: [\"target amount: \", data === null || data === void 0 ? void 0 : data.targetAmount, \" Klay\"]\n          }), /*#__PURE__*/_jsxs(\"div\", {\n            children: [\"target amount: \", data === null || data === void 0 ? void 0 : data.minFundingAmount, \" Klay\"]\n          }), /*#__PURE__*/_jsx(\"div\", {\n            children: \"description\"\n          }), /*#__PURE__*/_jsx(\"div\", {\n            children: data === null || data === void 0 ? void 0 : data.description\n          })]\n        }), /*#__PURE__*/_jsxs(Buttons, {\n          children: [/*#__PURE__*/_jsx(DeleteButton, {\n            onClick: deleteData,\n            children: \"\\uC0AD\\uC81C\\uD558\\uAE30\"\n          }), /*#__PURE__*/_jsx(OnChainButton, {\n            onClick: create,\n            children: \"\\uC628\\uCCB4\\uC778 \\uC62C\\uB9AC\\uAE30\"\n          })]\n        }), /*#__PURE__*/_jsx(\"h3\", {\n          children: \"\\u2B07\\uFE0F NFT \\uC774\\uBBF8\\uC9C0 \\uC5C5\\uB85C\\uB4DC\\uD558\\uAE30\"\n        }), /*#__PURE__*/_jsx(\"form\", {\n          children: /*#__PURE__*/_jsx(\"input\", {\n            type: \"file\",\n            multiple: true,\n            onChange: e => onChangeImage(e)\n          })\n        })]\n      }), showConnectWalletModal && /*#__PURE__*/_jsx(ConnectWalletModal, {})]\n    })\n  });\n};\n\nexport default VerifyCampaignModal;","map":null,"metadata":{},"sourceType":"module"}