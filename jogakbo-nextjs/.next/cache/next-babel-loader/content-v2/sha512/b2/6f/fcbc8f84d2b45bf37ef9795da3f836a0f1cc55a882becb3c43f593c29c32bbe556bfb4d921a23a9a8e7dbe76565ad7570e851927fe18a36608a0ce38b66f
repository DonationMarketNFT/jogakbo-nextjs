{"ast":null,"code":"import { sign } from \"jsonwebtoken\";\nimport { serialize } from \"cookie\";\nconst secret = process.env.SECRET;\nexport default async function (req, res) {\n  const {\n    myAddress\n  } = req.body; // Check in the database\n  // if a user with this username\n  // and password exists\n\n  if (myAddress !== \"0x00\") {\n    const token = sign({\n      exp: Math.floor(Date.now() / 1000) + 60 * 60 * 24 * 30,\n      // 30 days\n      address: myAddress\n    }, secret);\n    const serialised = serialize(\"OursiteJWT\", token, {\n      httpOnly: true,\n      secure: true,\n      sameSite: \"strict\",\n      maxAge: 60 * 60 * 24 * 30,\n      path: \"/\"\n    });\n    res.setHeader(\"Set-Cookie\", serialised);\n    res.status(200).json({\n      message: \"Success!\"\n    });\n  } else {\n    res.json({\n      message: `Invalid credentials!${myAddress}}`\n    });\n  }\n}","map":null,"metadata":{},"sourceType":"module"}